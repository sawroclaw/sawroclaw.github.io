/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"a7840be7fe6e8a66bcdd.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"07cbe319caa5440425d3.js"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,o,r="function"==typeof Symbol?Symbol:{},c=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function i(e,r,c,a){var i=r&&r.prototype instanceof u?r:u,l=Object.create(i.prototype);return t(l,"_invoke",function(e,t,r){var c,a,i,u=0,l=r||[],p=!1,d={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(e,t){return c=e,a=0,i=n,d.n=t,s}};function m(e,t){for(a=e,i=t,o=0;!p&&u&&!r&&o<l.length;o++){var r,c=l[o],m=d.p,f=c[2];e>3?(r=f===t)&&(i=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=n):c[0]<=m&&((r=e<2&&m<c[1])?(a=0,d.v=t,d.n=c[1]):m<f&&(r=e<3||c[0]>t||t>f)&&(c[4]=e,c[5]=t,d.n=f,a=0))}if(r||e>1)return s;throw p=!0,t}return function(r,l,f){if(u>1)throw TypeError("Generator is already running");for(p&&1===l&&m(l,f),a=l,i=f;(o=a<2?n:i)||!p;){c||(a?a<3?(a>1&&(d.n=-1),m(a,i)):d.n=i:d.v=i);try{if(u=2,c){if(a||(r="next"),o=c[r]){if(!(o=o.call(c,i)))throw TypeError("iterator result is not an object");if(!o.done)return o;i=o.value,a<2&&(a=0)}else 1===a&&(o=c.return)&&o.call(c),a<2&&(i=TypeError("The iterator does not provide a '"+r+"' method"),a=1);c=n}else if((o=(p=d.n<0)?i:e.call(t,d))!==s)break}catch(e){c=n,a=1,i=e}finally{u=1}}return{value:o,done:p}}}(e,c,a),!0),l}var s={};function u(){}function l(){}function p(){}o=Object.getPrototypeOf;var d=[][c]?o(o([][c]())):(t(o={},c,function(){return this}),o),m=p.prototype=u.prototype=Object.create(d);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,t(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=p,t(m,"constructor",p),t(p,"constructor",l),l.displayName="GeneratorFunction",t(p,a,"GeneratorFunction"),t(m),t(m,a,"Generator"),t(m,c,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:i,m:f}})()}function t(e,n,o,r){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}t=function(e,n,o,r){function a(n,o){t(e,n,function(e){return this._invoke(n,o,e)})}n?c?c(e,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):e[n]=o:(a("next",0),a("throw",1),a("return",2))},t(e,n,o,r)}function n(e,t,n,o,r,c,a){try{var i=e[c](a),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(o,r)}function o(e){return function(){var t=this,o=arguments;return new Promise(function(r,c){var a=e.apply(t,o);function i(e){n(a,r,c,i,s,"next",e)}function s(e){n(a,r,c,i,s,"throw",e)}i(void 0)})}}function r(e,t,n){var o=document.getElementById("result-title"),r=document.getElementById("result-message"),c=document.getElementById("result-icon"),a=document.getElementById("result-again");o&&(o.textContent=t),r&&(r.innerHTML=n),c&&(c.classList.remove("success","error"),c.classList.add(e?"success":"error")),a&&a.classList.toggle("hidden",e),["panel-select","panel-report","panel-result"].forEach(function(e){var t=document.getElementById(e);t&&("panel-result"===e?t.classList.remove("hidden"):t.classList.add("hidden"))})}function c(e){return e?e.replace(/[<>&'"]/g,function(e){return{"<":"&lt;",">":"&gt;","&":"&amp;","'":"&apos;",'"':"&quot;"}[e]}):""}Office.onReady(function(t){try{if(t.host===Office.HostType.Outlook){var n=function(e){["panel-select","panel-report","panel-result"].forEach(function(t){var n=document.getElementById(t);n&&(t===e?n.classList.remove("hidden"):n.classList.add("hidden"))})},a=document.getElementById("app-body");a&&(a.style.display="block");var i=Office.context.mailbox.item,s=document.getElementById("item-subject");s&&(s.textContent=i&&i.subject?i.subject:"(brak tematu)");var u=document.getElementById("runSendPost"),l=(document.getElementById("panel-select"),document.getElementById("panel-report"),document.getElementById("panel-result"),document.getElementById("report-phish")),p=document.getElementById("btn-back"),d=document.getElementById("result-close"),m=document.getElementById("result-again");u&&(u.addEventListener("click",function(){return n("panel-report")}),u.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n("panel-report"))})),l&&l.addEventListener("click",function(){!function(){var t=Office.context.mailbox.item;if(document.getElementById("phish-status"),t&&t.itemId){var n=[{id:"opt-answered",text:"Odpowiedziano na e-mail."},{id:"opt-downloaded",text:"Pobrano plik."},{id:"opt-opened",text:"Otworzono załącznik."},{id:"opt-visited",text:"Odwiedzono link."},{id:"opt-password",text:"Wprowadzono swoje hasło."},{id:"opt-forwarded",text:"Przesłano dalej ten e-mail."},{id:"opt-none",text:"Nie zrobiono nic z e-mailem."}].filter(function(e){var t;return null===(t=document.getElementById(e.id))||void 0===t?void 0:t.checked}).map(function(e){return e.text}),a=n.length?"<ul>".concat(n.map(function(e){return"<li>".concat(c(e),"</li>")}).join(""),"</ul>"):"<p>Brak zaznaczonych opcji.</p>",i="Zgłoszenie phishing — ".concat(t.subject||""),s="<p>Użytkownik zgłosił podejrzaną wiadomość. Wybrane opcje:</p>".concat(a,"<hr/><p>Oryginalny temat: ").concat(c(t.subject||"(brak)"),"</p>"),u=t.itemId;try{Office.context.mailbox.convertToEwsId&&(u=Office.context.mailbox.convertToEwsId(t.itemId))}catch(e){}h("Wysyłanie zgłoszenia...",!1),o(e().m(function t(){var n,o;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,p(u);case 1:return n=e.v,e.n=2,m(n);case 2:r(!0,"Dziękujemy — zgłoszenie zostało wysłane.","Twoje zgłoszenie zostało przekazane zespołowi ds. bezpieczeństwa."),e.n=4;break;case 3:e.p=3,o=e.v,console.error("EWS error:",o),r(!1,"Błąd wysyłania zgłoszenia","Wystąpił błąd: "+c(o&&o.message?o.message:JSON.stringify(o)));case 4:return e.a(2)}},t,null,[[0,3]])}))()}else h("Brak aktywnej wiadomości.",!0);function l(e){return new Promise(function(t,n){Office.context.mailbox.makeEwsRequestAsync(e,function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):n(e.error||e)})})}function p(e){return d.apply(this,arguments)}function d(){return(d=o(e().m(function t(n){var o,r,a;return e().w(function(e){for(;;)switch(e.n){case 0:return o='<?xml version="1.0" encoding="utf-8"?>\n      <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                     xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"\n                     xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"\n                     xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n        <soap:Header>\n          <t:RequestServerVersion Version="Exchange2016" />\n        </soap:Header>\n        <soap:Body>\n          <m:GetItem>\n            <m:ItemShape>\n              <t:BaseShape>IdOnly</t:BaseShape>\n              <t:IncludeMimeContent>true</t:IncludeMimeContent>\n            </m:ItemShape>\n            <m:ItemIds>\n              <t:ItemId Id="'.concat(c(n),'" />\n            </m:ItemIds>\n          </m:GetItem>\n        </soap:Body>\n      </soap:Envelope>'),e.n=1,l(o);case 1:if(r=e.v,(a=r.match(/<\w*:MimeContent[^>]*>([\s\S]*?)<\/\w*:MimeContent>/i))&&a[1]){e.n=2;break}throw new Error("MimeContent nie znaleziono w odpowiedzi EWS.");case 2:return e.a(2,a[1].trim())}},t)}))).apply(this,arguments)}function m(e){return f.apply(this,arguments)}function f(){return(f=o(e().m(function t(n){var o,r;return e().w(function(e){for(;;)switch(e.n){case 0:return o='<?xml version="1.0" encoding="utf-8"?>\n      <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                     xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"\n                     xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"\n                     xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n        <soap:Header>\n          <t:RequestServerVersion Version="Exchange2016" />\n        </soap:Header>\n        <soap:Body>\n          <m:CreateItem MessageDisposition="SendAndSaveCopy">\n            <m:SavedItemFolderId>\n              <t:DistinguishedFolderId Id="sentitems" />\n            </m:SavedItemFolderId>\n            <m:Items>\n              <t:Message>\n                <t:Subject>'.concat(c(i),'</t:Subject>\n                <t:Body BodyType="HTML">').concat(c(s),"</t:Body>\n                <t:ToRecipients>\n                  <t:Mailbox>\n                    <t:EmailAddress>").concat("soc@wroclaw.sa.gov.pl","</t:EmailAddress>\n                  </t:Mailbox>\n                </t:ToRecipients>\n                <t:Attachments>\n                  <t:FileAttachment>\n                    <t:Name>SuspectedMessage.eml</t:Name>\n                    <t:ContentType>message/rfc822</t:ContentType>\n                    <t:Content>").concat(n,"</t:Content>\n                  </t:FileAttachment>\n                </t:Attachments>\n              </t:Message>\n            </m:Items>\n          </m:CreateItem>\n        </soap:Body>\n      </soap:Envelope>"),e.n=1,l(o);case 1:return r=e.v,e.a(2,r)}},t)}))).apply(this,arguments)}function h(e,t){var n=document.getElementById("phish-status");n&&(n.textContent=e,n.style.color=t?"#b00020":"#2b7a0b")}}()}),p&&p.addEventListener("click",function(){return n("panel-select")}),d&&d.addEventListener("click",function(){return n("panel-select")}),m&&m.addEventListener("click",function(){n("panel-report"),document.querySelectorAll("#panel-report input[type='checkbox']").forEach(function(e){return e.checked=!1});var e=document.getElementById("phish-status");e&&(e.textContent="")}),n("panel-select")}}catch(e){console.error("Office.onReady handler error:",e)}})}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map