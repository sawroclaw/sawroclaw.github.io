/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"7121c82ebad299d57e76.css"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,o,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function c(e,r,i,a){var c=r&&r.prototype instanceof u?r:u,l=Object.create(c.prototype);return t(l,"_invoke",function(e,t,r){var i,a,c,u=0,l=r||[],d=!1,p={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(e,t){return i=e,a=0,c=n,p.n=t,s}};function m(e,t){for(a=e,c=t,o=0;!d&&u&&!r&&o<l.length;o++){var r,i=l[o],m=p.p,f=i[2];e>3?(r=f===t)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=n):i[0]<=m&&((r=e<2&&m<i[1])?(a=0,p.v=t,p.n=i[1]):m<f&&(r=e<3||i[0]>t||t>f)&&(i[4]=e,i[5]=t,p.n=f,a=0))}if(r||e>1)return s;throw d=!0,t}return function(r,l,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&m(l,f),a=l,c=f;(o=a<2?n:c)||!d;){i||(a?a<3?(a>1&&(p.n=-1),m(a,c)):p.n=c:p.v=c);try{if(u=2,i){if(a||(r="next"),o=i[r]){if(!(o=o.call(i,c)))throw TypeError("iterator result is not an object");if(!o.done)return o;c=o.value,a<2&&(a=0)}else 1===a&&(o=i.return)&&o.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=n}else if((o=(d=p.n<0)?c:e.call(t,p))!==s)break}catch(e){i=n,a=1,c=e}finally{u=1}}return{value:o,done:d}}}(e,i,a),!0),l}var s={};function u(){}function l(){}function d(){}o=Object.getPrototypeOf;var p=[][i]?o(o([][i]())):(t(o={},i,function(){return this}),o),m=d.prototype=u.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=d,t(m,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,a,"GeneratorFunction"),t(m),t(m,a,"Generator"),t(m,i,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:f}})()}function t(e,n,o,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,n,o,r){function a(n,o){t(e,n,function(e){return this._invoke(n,o,e)})}n?i?i(e,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):e[n]=o:(a("next",0),a("throw",1),a("return",2))},t(e,n,o,r)}function n(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function o(e){return function(){var t=this,o=arguments;return new Promise(function(r,i){var a=e.apply(t,o);function c(e){n(a,r,i,c,s,"next",e)}function s(e){n(a,r,i,c,s,"throw",e)}c(void 0)})}}var r=!1,i=!1;function a(){return a=o(e().m(function t(){var n,i,a,u,l,d,p,m,f,h,y,v,g;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(v=function(e,t){var n=document.getElementById("phish-status");n&&(n.textContent=e,n.style.color=t?"#b00020":"#2b7a0b")},!r){t.n=1;break}return console.warn("Już trwa wysyłanie — pomijam kolejne wywołanie"),t.a(2);case 1:if(r=!0,t.p=2,n=function(e){return new Promise(function(t,n){Office.context.mailbox.makeEwsRequestAsync(e,function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):n(e.error||e)})})},i=function(){var t=o(e().m(function t(o){var r,i,a;return e().w(function(e){for(;;)switch(e.n){case 0:return r='<?xml version="1.0" encoding="utf-8"?>\n        <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                       xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"\n                       xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"\n                       xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n          <soap:Header>\n            <t:RequestServerVersion Version="Exchange2016" />\n          </soap:Header>\n          <soap:Body>\n            <m:GetItem>\n              <m:ItemShape>\n                <t:BaseShape>IdOnly</t:BaseShape>\n                <t:IncludeMimeContent>true</t:IncludeMimeContent>\n              </m:ItemShape>\n              <m:ItemIds>\n                <t:ItemId Id="'.concat(s(o),'" />\n              </m:ItemIds>\n            </m:GetItem>\n          </soap:Body>\n        </soap:Envelope>'),e.n=1,n(r);case 1:if(i=e.v,(a=i.match(/<\w*:MimeContent[^>]*>([\s\S]*?)<\/\w*:MimeContent>/i))&&a[1]){e.n=2;break}throw new Error("MimeContent nie znaleziono w odpowiedzi EWS.");case 2:return e.a(2,a[1].trim())}},t)}));return function(e){return t.apply(this,arguments)}}(),a=function(){var t=o(e().m(function t(o){var r,i;return e().w(function(e){for(;;)switch(e.n){case 0:return r='<?xml version="1.0" encoding="utf-8"?>\n        <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                       xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"\n                       xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"\n                       xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n          <soap:Header>\n            <t:RequestServerVersion Version="Exchange2016" />\n          </soap:Header>\n          <soap:Body>\n            <m:CreateItem MessageDisposition="SendAndSaveCopy">\n              <m:SavedItemFolderId>\n                <t:DistinguishedFolderId Id="sentitems" />\n              </m:SavedItemFolderId>\n              <m:Items>\n                <t:Message>\n                  <t:Subject>'.concat(s(m),'</t:Subject>\n                  <t:Body BodyType="HTML">').concat(s(f),"</t:Body>\n                  <t:ToRecipients>\n                    <t:Mailbox>\n                      <t:EmailAddress>").concat(u,"</t:EmailAddress>\n                    </t:Mailbox>\n                  </t:ToRecipients>\n                  <t:Attachments>\n                    <t:FileAttachment>\n                      <t:Name>SuspectedMessage.eml</t:Name>\n                      <t:ContentType>message/rfc822</t:ContentType>\n                      <t:Content>").concat(o,"</t:Content>\n                    </t:FileAttachment>\n                  </t:Attachments>\n                </t:Message>\n              </m:Items>\n            </m:CreateItem>\n          </soap:Body>\n        </soap:Envelope>"),e.n=1,n(r);case 1:return i=e.v,e.a(2,i)}},t)}));return function(e){return t.apply(this,arguments)}}(),u="soc@wroclaw.sa.gov.pl",(l=Office.context.mailbox.item)&&l.itemId){t.n=3;break}return v("Brak aktywnej wiadomości.",!0),t.a(2);case 3:d=[{id:"opt-answered",text:"Odpowiedziano na e-mail."},{id:"opt-downloaded",text:"Pobrano plik."},{id:"opt-opened",text:"Otworzono załącznik."},{id:"opt-visited",text:"Odwiedzono link."},{id:"opt-password",text:"Wprowadzono swoje hasło."},{id:"opt-forwarded",text:"Przesłano dalej ten e-mail."},{id:"opt-none",text:"Nie zrobiono nic z e-mailem."}].filter(function(e){var t;return null===(t=document.getElementById(e.id))||void 0===t?void 0:t.checked}).map(function(e){return e.text}),p=d.length?"<ul>".concat(d.map(function(e){return"<li>".concat(s(e),"</li>")}).join(""),"</ul>"):"<p>Brak zaznaczonych opcji.</p>",m="Zgłoszenie phishing — ".concat(l.subject||""),f="<p>Użytkownik zgłosił podejrzaną wiadomość. Wybrane opcje:</p>".concat(p,"<hr/><p>Oryginalny temat: ").concat(s(l.subject||"(brak)"),"</p>"),h=l.itemId;try{Office.context.mailbox.convertToEwsId&&(h=Office.context.mailbox.convertToEwsId(l.itemId))}catch(e){}return v("Wysyłanie zgłoszenia...",!1),t.n=4,i(h);case 4:return y=t.v,t.n=5,a(y);case 5:c(!0,"Dziękujemy — zgłoszenie zostało wysłane.","Twoje zgłoszenie zostało przekazane zespołowi ds. bezpieczeństwa."),t.n=7;break;case 6:t.p=6,g=t.v,console.error("EWS error:",g),c(!1,"Błąd wysyłania zgłoszenia","Wystąpił błąd: "+s(g&&g.message?g.message:JSON.stringify(g)));case 7:return t.p=7,r=!1,t.f(7);case 8:return t.a(2)}},t,null,[[2,6,7,8]])})),a.apply(this,arguments)}function c(e,t,n){var o=document.getElementById("result-title"),r=document.getElementById("result-message"),i=document.getElementById("result-icon"),a=document.getElementById("result-again");o&&(o.textContent=t,o.style.textAlign="center"),r&&(r.innerHTML=n),i&&(i.innerHTML=e?'<svg width="64" height="64" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true"><circle cx="32" cy="32" r="32" fill="#c6f6e9"/><circle cx="32" cy="32" r="22" fill="#a8efd0"/><path d="M20 34 L28 42 L44 24" stroke="#065f3a" stroke-width="4" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>':'<svg width="64" height="64" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true"><circle cx="32" cy="32" r="32" fill="#ffd9d9"/><circle cx="32" cy="32" r="22" fill="#ffd0d0"/><path d="M22 22 L42 42 M42 22 L22 42" stroke="#a11a1a" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>'),a&&a.classList.toggle("hidden",e),["panel-select","panel-report","panel-result"].forEach(function(e){var t=document.getElementById(e);if(t)if("panel-result"===e)t.classList.remove("hidden"),requestAnimationFrame(function(){return t.classList.add("active")});else{t.classList.remove("active");var n=function(e){"opacity"!==e.propertyName&&"transform"!==e.propertyName||(t.classList.add("hidden"),t.removeEventListener("transitionend",n))};t.addEventListener("transitionend",n)}})}function s(e){return e?e.replace(/[<>&'"]/g,function(e){return{"<":"&lt;",">":"&gt;","&":"&amp;","'":"&apos;",'"':"&quot;"}[e]}):""}Office.onReady(function(e){try{if(i)return;if(i=!0,e.host===Office.HostType.Outlook){var t=function(e){["panel-select","panel-report","panel-result"].forEach(function(t){var n=document.getElementById(t);if(n)if(t===e)n.classList.remove("hidden"),requestAnimationFrame(function(){return n.classList.add("active")});else{n.classList.remove("active");var o=function(e){"opacity"!==e.propertyName&&"transform"!==e.propertyName||(n.classList.add("hidden"),n.removeEventListener("transitionend",o))};n.addEventListener("transitionend",o)}})},n=document.getElementById("app-body");n&&(n.style.display="block");var o=Office.context.mailbox.item,r=document.getElementById("item-subject");r&&(r.textContent=o&&o.subject?o.subject:"(brak tematu)");var c=document.getElementById("runSendPost"),s=document.getElementById("report-phish"),u=document.getElementById("btn-back"),l=document.getElementById("result-close"),d=document.getElementById("result-again");c&&(c.addEventListener("click",function(){return t("panel-report")}),c.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t("panel-report"))})),s&&s.addEventListener("click",function(){s.disabled=!0,function(){return a.apply(this,arguments)}().finally(function(){s.disabled=!1})}),u&&u.addEventListener("click",function(){return t("panel-select")}),l&&l.addEventListener("click",function(){return t("panel-select")}),d&&d.addEventListener("click",function(){t("panel-report"),document.querySelectorAll("#panel-report input[type='checkbox']").forEach(function(e){return e.checked=!1});var e=document.getElementById("phish-status");e&&(e.textContent="")}),t("panel-select")}}catch(e){console.error("Office.onReady handler error:",e)}})}(),function(){"use strict";new URL(n(58394),n.b)}()}();
//# sourceMappingURL=taskpane.js.map