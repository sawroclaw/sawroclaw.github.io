/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"1fda685b81e1123773f6.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"c1683399cdc58db4065b.js"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,o,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function c(e,r,i,a){var c=r&&r.prototype instanceof u?r:u,p=Object.create(c.prototype);return t(p,"_invoke",function(e,t,r){var i,a,c,u=0,p=r||[],m=!1,l={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(e,t){return i=e,a=0,c=n,l.n=t,s}};function d(e,t){for(a=e,c=t,o=0;!m&&u&&!r&&o<p.length;o++){var r,i=p[o],d=l.p,f=i[2];e>3?(r=f===t)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=n):i[0]<=d&&((r=e<2&&d<i[1])?(a=0,l.v=t,l.n=i[1]):d<f&&(r=e<3||i[0]>t||t>f)&&(i[4]=e,i[5]=t,l.n=f,a=0))}if(r||e>1)return s;throw m=!0,t}return function(r,p,f){if(u>1)throw TypeError("Generator is already running");for(m&&1===p&&d(p,f),a=p,c=f;(o=a<2?n:c)||!m;){i||(a?a<3?(a>1&&(l.n=-1),d(a,c)):l.n=c:l.v=c);try{if(u=2,i){if(a||(r="next"),o=i[r]){if(!(o=o.call(i,c)))throw TypeError("iterator result is not an object");if(!o.done)return o;c=o.value,a<2&&(a=0)}else 1===a&&(o=i.return)&&o.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=n}else if((o=(m=l.n<0)?c:e.call(t,l))!==s)break}catch(e){i=n,a=1,c=e}finally{u=1}}return{value:o,done:m}}}(e,i,a),!0),p}var s={};function u(){}function p(){}function m(){}o=Object.getPrototypeOf;var l=[][i]?o(o([][i]())):(t(o={},i,function(){return this}),o),d=m.prototype=u.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,t(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return p.prototype=m,t(d,"constructor",m),t(m,"constructor",p),p.displayName="GeneratorFunction",t(m,a,"GeneratorFunction"),t(d),t(d,a,"Generator"),t(d,i,function(){return this}),t(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:f}})()}function t(e,n,o,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,n,o,r){function a(n,o){t(e,n,function(e){return this._invoke(n,o,e)})}n?i?i(e,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):e[n]=o:(a("next",0),a("throw",1),a("return",2))},t(e,n,o,r)}function n(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function o(e){return function(){var t=this,o=arguments;return new Promise(function(r,i){var a=e.apply(t,o);function c(e){n(a,r,i,c,s,"next",e)}function s(e){n(a,r,i,c,s,"throw",e)}c(void 0)})}}function r(){var t=Office.context.mailbox.item,n=document.getElementById("phish-status");if(t&&t.itemId){var r=[{id:"opt-answered",text:"Odpowiedziano na e-mail."},{id:"opt-downloaded",text:"Pobrano plik."},{id:"opt-opened",text:"Otworzono załącznik."},{id:"opt-visited",text:"Odwiedzono link."},{id:"opt-password",text:"Wprowadzono swoje hasło."},{id:"opt-forwarded",text:"Przesłano dalej ten e-mail."},{id:"opt-none",text:"Nie zrobiono nic z e-mailem."}].filter(function(e){var t;return null===(t=document.getElementById(e.id))||void 0===t?void 0:t.checked}).map(function(e){return e.text}),a=r.length?"<ul>".concat(r.map(function(e){return"<li>".concat(i(e),"</li>")}).join(""),"</ul>"):"<p>Brak zaznaczonych opcji.</p>",c="Zgłoszenie phishing — ".concat(t.subject||""),s="<p>Użytkownik zgłosił podejrzaną wiadomość. Wybrane opcje:</p>".concat(a,"<hr/><p>Oryginalny temat: ").concat(i(t.subject||"(brak)"),"</p>"),u=t.itemId;try{Office.context.mailbox.convertToEwsId&&(u=Office.context.mailbox.convertToEwsId(t.itemId))}catch(e){}h("Wysyłanie zgłoszenia...",!1),o(e().m(function t(){var n,o;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,m(u);case 1:return n=e.v,e.n=2,d(n);case 2:h("Zgłoszenie phishing wysłane.",!1),e.n=4;break;case 3:e.p=3,o=e.v,console.error("EWS error:",o),h("Błąd wysyłania zgłoszenia: "+(o&&o.message?o.message:JSON.stringify(o)),!0);case 4:return e.a(2)}},t,null,[[0,3]])}))()}else h("Brak aktywnej wiadomości.",!0);function p(e){return new Promise(function(t,n){Office.context.mailbox.makeEwsRequestAsync(e,function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):n(e.error||e)})})}function m(e){return l.apply(this,arguments)}function l(){return(l=o(e().m(function t(n){var o,r,a;return e().w(function(e){for(;;)switch(e.n){case 0:return o='<?xml version="1.0" encoding="utf-8"?>\n      <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                     xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"\n                     xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"\n                     xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n        <soap:Header>\n          <t:RequestServerVersion Version="Exchange2016" />\n        </soap:Header>\n        <soap:Body>\n          <m:GetItem>\n            <m:ItemShape>\n              <t:BaseShape>IdOnly</t:BaseShape>\n              <t:IncludeMimeContent>true</t:IncludeMimeContent>\n            </m:ItemShape>\n            <m:ItemIds>\n              <t:ItemId Id="'.concat(i(n),'" />\n            </m:ItemIds>\n          </m:GetItem>\n        </soap:Body>\n      </soap:Envelope>'),e.n=1,p(o);case 1:if(r=e.v,(a=r.match(/<\w*:MimeContent[^>]*>([\s\S]*?)<\/\w*:MimeContent>/i))&&a[1]){e.n=2;break}throw new Error("MimeContent nie znaleziono w odpowiedzi EWS.");case 2:return e.a(2,a[1].trim())}},t)}))).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=o(e().m(function t(n){var o,r;return e().w(function(e){for(;;)switch(e.n){case 0:return o='<?xml version="1.0" encoding="utf-8"?>\n      <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                     xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"\n                     xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"\n                     xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n        <soap:Header>\n          <t:RequestServerVersion Version="Exchange2016" />\n        </soap:Header>\n        <soap:Body>\n          <m:CreateItem MessageDisposition="SendAndSaveCopy">\n            <m:SavedItemFolderId>\n              <t:DistinguishedFolderId Id="sentitems" />\n            </m:SavedItemFolderId>\n            <m:Items>\n              <t:Message>\n                <t:Subject>'.concat(i(c),'</t:Subject>\n                <t:Body BodyType="HTML">').concat(i(s),"</t:Body>\n                <t:ToRecipients>\n                  <t:Mailbox>\n                    <t:EmailAddress>").concat("rafal.sulkowski@wroclaw.sa.gov.pl","</t:EmailAddress>\n                  </t:Mailbox>\n                </t:ToRecipients>\n                <t:Attachments>\n                  <t:FileAttachment>\n                    <t:Name>SuspectedMessage.eml</t:Name>\n                    <t:ContentType>message/rfc822</t:ContentType>\n                    <t:Content>").concat(n,"</t:Content>\n                  </t:FileAttachment>\n                </t:Attachments>\n              </t:Message>\n            </m:Items>\n          </m:CreateItem>\n        </soap:Body>\n      </soap:Envelope>"),e.n=1,p(o);case 1:return r=e.v,e.a(2,r)}},t)}))).apply(this,arguments)}function h(e,t){n&&(n.textContent=e,n.style.color=t?"#b00020":"#2b7a0b")}}function i(e){return e?e.replace(/[<>&'"]/g,function(e){return{"<":"&lt;",">":"&gt;","&":"&amp;","'":"&apos;",'"':"&quot;"}[e]}):""}Office.onReady(function(e){try{if(e.host===Office.HostType.Outlook){var t=document.getElementById("app-body");t&&(t.style.display="block");var n=Office.context.mailbox.item,o=document.getElementById("item-subject");o&&(o.textContent=n&&n.subject?n.subject:"(brak tematu)");var i=function(){var e=document.getElementById("report-phish");e&&(e.onclick=r)};i(),"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",i)}}catch(e){console.error("Office.onReady handler error:",e)}})}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map