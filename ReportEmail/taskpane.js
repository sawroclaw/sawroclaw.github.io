!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"1fda685b81e1123773f6.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"e957877cb792e0741959.js"}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var a=o.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=o[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var e=Office.context.mailbox.item,n=document.getElementById("phish-status");if(e&&e.itemId){var o=[{id:"opt-answered",text:"Odpowiedziano na e-mail."},{id:"opt-downloaded",text:"Pobrano plik."},{id:"opt-opened",text:"Otworzono załącznik."},{id:"opt-visited",text:"Odwiedzono link."},{id:"opt-password",text:"Wprowadzono swoje hasło."},{id:"opt-forwarded",text:"Przesłano dalej ten e-mail."},{id:"opt-none",text:"Nie zrobiono nic z e-mailem."}].filter(function(e){var t;return null===(t=document.getElementById(e.id))||void 0===t?void 0:t.checked}).map(function(e){return e.text}),a=o.length?"<ul>".concat(o.map(function(e){return"<li>".concat(t(e),"</li>")}).join(""),"</ul>"):"<p>Brak zaznaczonych opcji.</p>",i="Zgłoszenie phishing — ".concat(e.subject||""),s="<p>Użytkownik zgłosił podejrzaną wiadomość. Wybrane opcje:</p>".concat(a,"<hr/><p>Oryginalny temat: ").concat(t(e.subject||"(brak)"),"</p>"),r=e.itemId;try{Office.context.mailbox.convertToEwsId&&(r=Office.context.mailbox.convertToEwsId(e.itemId))}catch(e){}var c='<?xml version="1.0" encoding="utf-8"?>\n    <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                   xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"\n                   xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"\n                   xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n      <soap:Header>\n        <t:RequestServerVersion Version="Exchange2016" />\n      </soap:Header>\n      <soap:Body>\n        <m:CreateItem MessageDisposition="SendAndSaveCopy">\n          <m:SavedItemFolderId>\n            <t:DistinguishedFolderId Id="sentitems" />\n          </m:SavedItemFolderId>\n          <m:Items>\n            <t:Message>\n              <t:Subject>'.concat(t(i),'</t:Subject>\n              <t:Body BodyType="HTML">').concat(t(s),"</t:Body>\n              <t:ToRecipients>\n                <t:Mailbox>\n                  <t:EmailAddress>").concat("rafal.sulkowski@wroclaw.sa.gov.pl",'</t:EmailAddress>\n                </t:Mailbox>\n              </t:ToRecipients>\n              <t:Attachments>\n                <t:ItemAttachment>\n                  <t:Name>SuspectedMessage.msg</t:Name>\n                  <t:Item>\n                    <t:Message>\n                      <t:ItemId Id="').concat(t(r),'" />\n                    </t:Message>\n                  </t:Item>\n                </t:ItemAttachment>\n              </t:Attachments>\n            </t:Message>\n          </m:Items>\n        </m:CreateItem>\n      </soap:Body>\n    </soap:Envelope>');d("Wysyłanie zgłoszenia...",!1),Office.context.mailbox.makeEwsRequestAsync(c,function(e){if(e.status===Office.AsyncResultStatus.Succeeded)d("Zgłoszenie phishing wysłane.",!1);else{var t=e.error||{};console.error("EWS error:",t),d("Błąd wysyłania zgłoszenia: "+(t.message||JSON.stringify(t)),!0)}})}else d("Brak aktywnej wiadomości.",!0);function d(e,t){n&&(n.textContent=e,n.style.color=t?"#b00020":"#2b7a0b")}}function t(e){return e?e.replace(/[<>&'"]/g,function(e){return{"<":"&lt;",">":"&gt;","&":"&amp;","'":"&apos;",'"':"&quot;"}[e]}):""}Office.onReady(function(t){try{if(t.host===Office.HostType.Outlook){var n=document.getElementById("app-body");n&&(n.style.display="block");var o=Office.context.mailbox.item,a=document.getElementById("item-subject");a&&(a.textContent=o&&o.subject?o.subject:"(brak tematu)");var i=function(){var t=document.getElementById("report-phish");t&&(t.onclick=e)};i(),"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",i)}}catch(e){console.error("Office.onReady handler error:",e)}})}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map