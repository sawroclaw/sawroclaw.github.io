{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office */\n/* Minimalny taskpane dla zgłaszania phishing — zbiera checkboxy, dołącza oryginalną wiadomość i wysyła EWS CreateItem */\nOffice.onReady((info) => {\n  try {\n    if (info.host === Office.HostType.Outlook) {\n      // Pokaż UI (jeśli istnieje)\n      const appBody = document.getElementById(\"app-body\");\n      if (appBody) appBody.style.display = \"block\";\n\n      // Wstaw temat aktywnej wiadomości (jeśli element istnieje)\n      const item = Office.context.mailbox.item;\n      const subjEl = document.getElementById(\"item-subject\");\n      if (subjEl) subjEl.textContent = (item && item.subject) ? item.subject : \"(brak tematu)\";\n\n      // Podłącz przycisk zgłoszenia (jeśli element istnieje). Jeśli element nie istnieje teraz,\n      // podłączenie zostanie spróbowane po DOMContentLoaded poniżej.\n      const tryAttach = () => {\n        const btn = document.getElementById(\"report-phish\");\n        if (btn) btn.onclick = sendPhishingReport;\n      };\n      tryAttach();\n      // jeśli skrypt załadował się przed DOM, upewnij się, że dołączymy handler po pełnym załadowaniu\n      if (document.readyState === \"loading\") {\n        document.addEventListener(\"DOMContentLoaded\", tryAttach);\n      }\n    }\n  } catch (err) {\n    // Zawsze loguj błędy do konsoli — ułatwia debugowanie \"Script error\"\n    // (Outlook/Edge czasem maskuje szczegóły więc zapisujemy tu co możemy)\n    console.error(\"Office.onReady handler error:\", err);\n  }\n});\n\nfunction sendPhishingReport() {\n  const REPORT_ADDRESS = \"rafal.sulkowski@wroclaw.sa.gov.pl\"; // <- ustaw właściwy adres\n  const item = Office.context.mailbox.item;\n  const statusEl = document.getElementById(\"phish-status\");\n\n  if (!item || !item.itemId) {\n    setStatus(\"Brak aktywnej wiadomości.\", true);\n    return;\n  }\n\n  const opts = [\n    { id: \"opt-answered\", text: \"Odpowiedziano na e-mail.\" },\n    { id: \"opt-downloaded\", text: \"Pobrano plik.\" },\n    { id: \"opt-opened\", text: \"Otworzono załącznik.\" },\n    { id: \"opt-visited\", text: \"Odwiedzono link.\" },\n    { id: \"opt-password\", text: \"Wprowadzono swoje hasło.\" },\n    { id: \"opt-forwarded\", text: \"Przesłano dalej ten e-mail.\" },\n    { id: \"opt-none\", text: \"Nie zrobiono nic z e-mailem.\" }\n  ];\n\n  const selected = opts.filter(o => document.getElementById(o.id)?.checked).map(o => o.text);\n  const selectionHtml = selected.length ? `<ul>${selected.map(s => `<li>${escapeXml(s)}</li>`).join(\"\")}</ul>` : \"<p>Brak zaznaczonych opcji.</p>\";\n  const reportSubject = `Zgłoszenie phishing — ${item.subject || \"\"}`;\n  const reportBody = `<p>Użytkownik zgłosił podejrzaną wiadomość. Wybrane opcje:</p>${selectionHtml}<hr/><p>Oryginalny temat: ${escapeXml(item.subject || \"(brak)\")}</p>`;\n\n  // Spróbuj użyć itemId bez konwersji; jeśli w środowisku okaże się konieczny ConvertId, dorzucę konwersję SOAP.\n  let ewsId = item.itemId;\n  try {\n    if (Office.context.mailbox.convertToEwsId) {\n      ewsId = Office.context.mailbox.convertToEwsId(item.itemId);\n    }\n  } catch (e) {\n    // fallback - użyj item.itemId\n  }\n\n  const req = `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n    <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                   xmlns:m=\"http://schemas.microsoft.com/exchange/services/2006/messages\"\n                   xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\"\n                   xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n      <soap:Header>\n        <t:RequestServerVersion Version=\"Exchange2016\" />\n      </soap:Header>\n      <soap:Body>\n        <m:CreateItem MessageDisposition=\"SendAndSaveCopy\">\n          <m:SavedItemFolderId>\n            <t:DistinguishedFolderId Id=\"sentitems\" />\n          </m:SavedItemFolderId>\n          <m:Items>\n            <t:Message>\n              <t:Subject>${escapeXml(reportSubject)}</t:Subject>\n              <t:Body BodyType=\"HTML\">${escapeXml(reportBody)}</t:Body>\n              <t:ToRecipients>\n                <t:Mailbox>\n                  <t:EmailAddress>${REPORT_ADDRESS}</t:EmailAddress>\n                </t:Mailbox>\n              </t:ToRecipients>\n              <t:Attachments>\n                <t:ItemAttachment>\n                  <t:Name>SuspectedMessage.msg</t:Name>\n                  <t:Item>\n                    <t:Message>\n                      <t:ItemId Id=\"${escapeXml(ewsId)}\" />\n                    </t:Message>\n                  </t:Item>\n                </t:ItemAttachment>\n              </t:Attachments>\n            </t:Message>\n          </m:Items>\n        </m:CreateItem>\n      </soap:Body>\n    </soap:Envelope>`;\n\n  setStatus(\"Wysyłanie zgłoszenia...\", false);\n  Office.context.mailbox.makeEwsRequestAsync(req, function(asyncResult) {\n    if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\n      setStatus(\"Zgłoszenie phishing wysłane.\", false);\n    } else {\n      // pokaż więcej informacji, jeśli są dostępne\n      const err = asyncResult.error || {};\n      console.error(\"EWS error:\", err);\n      const msg = err.message || JSON.stringify(err);\n      setStatus(\"Błąd wysyłania zgłoszenia: \" + msg, true);\n    }\n  });\n\n  function setStatus(msg, isError) {\n    if (!statusEl) return;\n    statusEl.textContent = msg;\n    statusEl.style.color = isError ? \"#b00020\" : \"#2b7a0b\";\n  }\n}\n\nfunction escapeXml(s) {\n  return (!s) ? \"\" : s.replace(/[<>&'\"]/g, c => ({ \"<\":\"&lt;\", \">\":\"&gt;\", \"&\":\"&amp;\", \"'\":\"&apos;\", '\"':\"&quot;\" }[c]));\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html lang=\\\"pl\\\"> <head> <meta charset=\\\"utf-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <title>Report Phishing</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body> <main id=\\\"app-body\\\"> <h1>Zgłoś phishing</h1> <p><label id=\\\"item-subject\\\"></label></p> <section id=\\\"phish-report\\\"> <div> <label><input type=\\\"checkbox\\\" id=\\\"opt-answered\\\"> Odpowiedziano na e-mail.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-downloaded\\\"> Pobrano plik.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-opened\\\"> Otworzono załącznik.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-visited\\\"> Odwiedzono link.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-password\\\"> Wprowadzono swoje hasło.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-forwarded\\\"> Przesłano dalej ten e-mail.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-none\\\"> Nie zrobiono nic z e-mailem.</label><br> </div> <div role=\\\"button\\\" id=\\\"report-phish\\\" class=\\\"btn-primary\\\" style=\\\"margin-top:10px\\\"> Zgłoś phishing (wyślij) </div> <p id=\\\"phish-status\\\" style=\\\"margin-top:8px;color:#666;font-size:.9em\\\"></p> </section> </main> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","sendPhishingReport","item","Office","context","mailbox","statusEl","getElementById","itemId","selected","id","text","filter","_document$getElementB","checked","map","selectionHtml","concat","s","escapeXml","join","reportSubject","subject","reportBody","ewsId","convertToEwsId","req","setStatus","makeEwsRequestAsync","asyncResult","status","AsyncResultStatus","Succeeded","err","error","console","message","JSON","stringify","msg","isError","textContent","style","color","c","onReady","info","host","HostType","Outlook","appBody","display","subjEl","tryAttach","btn","onclick","readyState","addEventListener","URL"],"sourceRoot":""}