{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office */\n/* Minimalny taskpane dla zgłaszania phishing — zbiera checkboxy, dołącza oryginalną wiadomość i wysyła EWS CreateItem */\nOffice.onReady((info) => {\n  try {\n    if (info.host === Office.HostType.Outlook) {\n      // Pokaż UI (jeśli istnieje)\n      const appBody = document.getElementById(\"app-body\");\n      if (appBody) appBody.style.display = \"block\";\n\n      // Wstaw temat aktywnej wiadomości (jeśli element istnieje)\n      const item = Office.context.mailbox.item;\n      const subjEl = document.getElementById(\"item-subject\");\n      if (subjEl) subjEl.textContent = (item && item.subject) ? item.subject : \"(brak tematu)\";\n\n      // Podłącz przycisk zgłoszenia (jeśli element istnieje). Jeśli element nie istnieje teraz,\n      // podłączenie zostanie spróbowane po DOMContentLoaded poniżej.\n      const tryAttach = () => {\n        const btn = document.getElementById(\"report-phish\");\n        if (btn) btn.onclick = sendPhishingReport;\n      };\n      tryAttach();\n      // jeśli skrypt załadował się przed DOM, upewnij się, że dołączymy handler po pełnym załadowaniu\n      if (document.readyState === \"loading\") {\n        document.addEventListener(\"DOMContentLoaded\", tryAttach);\n      }\n    }\n  } catch (err) {\n    // Zawsze loguj błędy do konsoli — ułatwia debugowanie \"Script error\"\n    // (Outlook/Edge czasem maskuje szczegóły więc zapisujemy tu co możemy)\n    console.error(\"Office.onReady handler error:\", err);\n  }\n});\n\nfunction sendPhishingReport() {\n  const REPORT_ADDRESS = \"rafal.sulkowski@wroclaw.sa.gov.pl\"; // <- ustaw właściwy adres\n  const item = Office.context.mailbox.item;\n  const statusEl = document.getElementById(\"phish-status\");\n\n  if (!item || !item.itemId) {\n    setStatus(\"Brak aktywnej wiadomości.\", true);\n    return;\n  }\n\n  const opts = [\n    { id: \"opt-answered\", text: \"Odpowiedziano na e-mail.\" },\n    { id: \"opt-downloaded\", text: \"Pobrano plik.\" },\n    { id: \"opt-opened\", text: \"Otworzono załącznik.\" },\n    { id: \"opt-visited\", text: \"Odwiedzono link.\" },\n    { id: \"opt-password\", text: \"Wprowadzono swoje hasło.\" },\n    { id: \"opt-forwarded\", text: \"Przesłano dalej ten e-mail.\" },\n    { id: \"opt-none\", text: \"Nie zrobiono nic z e-mailem.\" }\n  ];\n\n  const selected = opts.filter(o => document.getElementById(o.id)?.checked).map(o => o.text);\n  const selectionHtml = selected.length ? `<ul>${selected.map(s => `<li>${escapeXml(s)}</li>`).join(\"\")}</ul>` : \"<p>Brak zaznaczonych opcji.</p>\";\n  const reportSubject = `Zgłoszenie phishing — ${item.subject || \"\"}`;\n  const reportBody = `<p>Użytkownik zgłosił podejrzaną wiadomość. Wybrane opcje:</p>${selectionHtml}<hr/><p>Oryginalny temat: ${escapeXml(item.subject || \"(brak)\")}</p>`;\n\n  // uzyskaj EWS Id jeśli dostępne\n  let ewsId = item.itemId;\n  try {\n    if (Office.context.mailbox.convertToEwsId) {\n      ewsId = Office.context.mailbox.convertToEwsId(item.itemId);\n    }\n  } catch (e) {\n    // fallback - użyj item.itemId\n  }\n\n  // Promise wrapper dla makeEwsRequestAsync (zwraca response XML jako string)\n  function makeEwsRequestPromise(soap) {\n    return new Promise((resolve, reject) => {\n      Office.context.mailbox.makeEwsRequestAsync(soap, (res) => {\n        if (res.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(res.value);\n        } else {\n          reject(res.error || res);\n        }\n      });\n    });\n  }\n\n  // Pobierz MimeContent oryginalnej wiadomości (base64)\n  async function getMimeContentForItem(id) {\n    const getItemReq = `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n      <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                     xmlns:m=\"http://schemas.microsoft.com/exchange/services/2006/messages\"\n                     xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\"\n                     xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n        <soap:Header>\n          <t:RequestServerVersion Version=\"Exchange2016\" />\n        </soap:Header>\n        <soap:Body>\n          <m:GetItem>\n            <m:ItemShape>\n              <t:BaseShape>IdOnly</t:BaseShape>\n              <t:IncludeMimeContent>true</t:IncludeMimeContent>\n            </m:ItemShape>\n            <m:ItemIds>\n              <t:ItemId Id=\"${escapeXml(id)}\" />\n            </m:ItemIds>\n          </m:GetItem>\n        </soap:Body>\n      </soap:Envelope>`;\n\n    const resp = await makeEwsRequestPromise(getItemReq);\n    // wyciągnij zawartość MimeContent (ignoring namespace) - regex jest prostszy i działa na zwróconym XML stringu\n    const m = resp.match(/<\\w*:MimeContent[^>]*>([\\s\\S]*?)<\\/\\w*:MimeContent>/i);\n    if (!m || !m[1]) {\n      throw new Error(\"MimeContent nie znaleziono w odpowiedzi EWS.\");\n    }\n    return m[1].trim(); // base64\n  }\n\n  // Utwórz i wyślij raport z plikiem .eml jako FileAttachment (content = base64 mime)\n  async function createAndSendReport(mimeBase64) {\n    const createReq = `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n      <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                     xmlns:m=\"http://schemas.microsoft.com/exchange/services/2006/messages\"\n                     xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\"\n                     xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n        <soap:Header>\n          <t:RequestServerVersion Version=\"Exchange2016\" />\n        </soap:Header>\n        <soap:Body>\n          <m:CreateItem MessageDisposition=\"SendAndSaveCopy\">\n            <m:SavedItemFolderId>\n              <t:DistinguishedFolderId Id=\"sentitems\" />\n            </m:SavedItemFolderId>\n            <m:Items>\n              <t:Message>\n                <t:Subject>${escapeXml(reportSubject)}</t:Subject>\n                <t:Body BodyType=\"HTML\">${escapeXml(reportBody)}</t:Body>\n                <t:ToRecipients>\n                  <t:Mailbox>\n                    <t:EmailAddress>${REPORT_ADDRESS}</t:EmailAddress>\n                  </t:Mailbox>\n                </t:ToRecipients>\n                <t:Attachments>\n                  <t:FileAttachment>\n                    <t:Name>SuspectedMessage.eml</t:Name>\n                    <t:ContentType>message/rfc822</t:ContentType>\n                    <t:Content>${mimeBase64}</t:Content>\n                  </t:FileAttachment>\n                </t:Attachments>\n              </t:Message>\n            </m:Items>\n          </m:CreateItem>\n        </soap:Body>\n      </soap:Envelope>`;\n\n    const resp = await makeEwsRequestPromise(createReq);\n    return resp;\n  }\n\n  setStatus(\"Wysyłanie zgłoszenia...\", false);\n\n  // wykonaj sekwencję: GetItem -> CreateItem\n  (async () => {\n    try {\n      const mimeBase64 = await getMimeContentForItem(ewsId);\n      await createAndSendReport(mimeBase64);\n      setStatus(\"Zgłoszenie phishing wysłane.\", false);\n    } catch (err) {\n      console.error(\"EWS error:\", err);\n      const msg = (err && err.message) ? err.message : JSON.stringify(err);\n      setStatus(\"Błąd wysyłania zgłoszenia: \" + msg, true);\n    }\n  })();\n\n  function setStatus(msg, isError) {\n    if (!statusEl) return;\n    statusEl.textContent = msg;\n    statusEl.style.color = isError ? \"#b00020\" : \"#2b7a0b\";\n  }\n}\n\nfunction escapeXml(s) {\n  return (!s) ? \"\" : s.replace(/[<>&'\"]/g, c => ({ \"<\":\"&lt;\", \">\":\"&gt;\", \"&\":\"&amp;\", \"'\":\"&apos;\", '\"':\"&quot;\" }[c]));\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html lang=\\\"pl\\\"> <head> <meta charset=\\\"utf-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <title>Report Phishing</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body> <main id=\\\"app-body\\\"> <h1>Zgłoś phishing</h1> <p><label id=\\\"item-subject\\\"></label></p> <section id=\\\"phish-report\\\"> <div> <label><input type=\\\"checkbox\\\" id=\\\"opt-answered\\\"> Odpowiedziano na e-mail.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-downloaded\\\"> Pobrano plik.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-opened\\\"> Otworzono załącznik.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-visited\\\"> Odwiedzono link.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-password\\\"> Wprowadzono swoje hasło.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-forwarded\\\"> Przesłano dalej ten e-mail.</label><br> <label><input type=\\\"checkbox\\\" id=\\\"opt-none\\\"> Nie zrobiono nic z e-mailem.</label><br> </div> <div role=\\\"button\\\" id=\\\"report-phish\\\" class=\\\"btn-primary\\\" style=\\\"margin-top:10px\\\"> Zgłoś phishing (wyślij) </div> <p id=\\\"phish-status\\\" style=\\\"margin-top:8px;color:#666;font-size:.9em\\\"></p> </section> </main> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","sendPhishingReport","item","Office","context","mailbox","statusEl","getElementById","itemId","selected","id","text","filter","_document$getElementB","checked","map","selectionHtml","concat","s","escapeXml","join","reportSubject","subject","reportBody","ewsId","convertToEwsId","setStatus","_callee","mimeBase64","_t","_context","getMimeContentForItem","createAndSendReport","console","error","message","JSON","stringify","makeEwsRequestPromise","soap","reject","makeEwsRequestAsync","res","status","AsyncResultStatus","Succeeded","_x","_getMimeContentForItem","_callee2","getItemReq","resp","_context2","match","trim","_x2","_createAndSendReport","_callee3","createReq","_context3","msg","isError","textContent","style","color","onReady","info","host","HostType","Outlook","appBody","display","subjEl","tryAttach","btn","onclick","readyState","addEventListener","err","URL"],"sourceRoot":""}